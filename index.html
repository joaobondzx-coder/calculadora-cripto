<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Criptomoedas - Pre√ßos em Tempo Real</title>
    <meta name="description" content="Calcule o valor de suas criptomoedas em tempo real com gr√°ficos e hist√≥rico semanal">
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/recharts@2.5.0/dist/Recharts.js"></script>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;
        const { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer } = Recharts;

        // √çcones SVG simples
        const TrendingUp = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline>
                <polyline points="17 6 23 6 23 12"></polyline>
            </svg>
        );

        const TrendingDown = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polyline points="23 18 13.5 8.5 8.5 13.5 1 6"></polyline>
                <polyline points="17 18 23 18 23 12"></polyline>
            </svg>
        );

        const RefreshCw = ({ className }) => (
            <svg className={className} width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polyline points="23 4 23 10 17 10"></polyline>
                <polyline points="1 20 1 14 7 14"></polyline>
                <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
            </svg>
        );

        const DollarSign = ({ className }) => (
            <svg className={className} width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <line x1="12" y1="1" x2="12" y2="23"></line>
                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
            </svg>
        );

        const BarChart3 = ({ className }) => (
            <svg className={className} width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M3 3v18h18"></path>
                <path d="M18 17V9"></path>
                <path d="M13 17V5"></path>
                <path d="M8 17v-3"></path>
            </svg>
        );

        function CryptoCalculator() {
            const [cryptoPrices, setCryptoPrices] = useState({
                bitcoin: { price: null, change: null },
                ethereum: { price: null, change: null },
                cardano: { price: null, change: null },
                solana: { price: null, change: null }
            });
            const [selectedCrypto, setSelectedCrypto] = useState('bitcoin');
            const [amount, setAmount] = useState('');
            const [currency, setCurrency] = useState('BRL');
            const [loading, setLoading] = useState(true);
            const [lastUpdate, setLastUpdate] = useState('');
            const [chartData, setChartData] = useState([]);
            const [loadingChart, setLoadingChart] = useState(false);
            const [showChart, setShowChart] = useState(false);

            const cryptoNames = {
                bitcoin: 'Bitcoin (BTC)',
                ethereum: 'Ethereum (ETH)',
                cardano: 'Cardano (ADA)',
                solana: 'Solana (SOL)'
            };

            const fetchPrices = async () => {
                setLoading(true);
                try {
                    const currencyParam = currency.toLowerCase();
                    const response = await fetch(
                        `https://api.coingecko.com/api/v3/simple/price?ids=bitcoin,ethereum,cardano,solana&vs_currencies=${currencyParam}&include_24hr_change=true`
                    );
                    const data = await response.json();
                    
                    const prices = {
                        bitcoin: {
                            price: data.bitcoin[currencyParam],
                            change: data.bitcoin[`${currencyParam}_24h_change`]
                        },
                        ethereum: {
                            price: data.ethereum[currencyParam],
                            change: data.ethereum[`${currencyParam}_24h_change`]
                        },
                        cardano: {
                            price: data.cardano[currencyParam],
                            change: data.cardano[`${currencyParam}_24h_change`]
                        },
                        solana: {
                            price: data.solana[currencyParam],
                            change: data.solana[`${currencyParam}_24h_change`]
                        }
                    };
                    
                    setCryptoPrices(prices);
                    setLastUpdate(new Date().toLocaleTimeString('pt-BR'));
                } catch (error) {
                    console.error('Erro ao buscar pre√ßos:', error);
                }
                setLoading(false);
            };

            const fetchWeeklyData = async (crypto) => {
                setLoadingChart(true);
                try {
                    const currencyParam = currency.toLowerCase();
                    const response = await fetch(
                        `https://api.coingecko.com/api/v3/coins/${crypto}/market_chart?vs_currency=${currencyParam}&days=7&interval=daily`
                    );
                    const data = await response.json();
                    
                    const formattedData = data.prices.map((item) => {
                        const date = new Date(item[0]);
                        return {
                            date: date.toLocaleDateString('pt-BR', { day: '2-digit', month: '2-digit' }),
                            price: item[1].toFixed(2),
                            fullDate: date.toLocaleDateString('pt-BR')
                        };
                    });
                    
                    setChartData(formattedData);
                } catch (error) {
                    console.error('Erro ao buscar dados do gr√°fico:', error);
                }
                setLoadingChart(false);
            };

            useEffect(() => {
                fetchPrices();
                const interval = setInterval(fetchPrices, 60000);
                return () => clearInterval(interval);
            }, [currency]);

            useEffect(() => {
                if (showChart) {
                    fetchWeeklyData(selectedCrypto);
                }
            }, [selectedCrypto, currency, showChart]);

            const calculateValue = () => {
                const numAmount = parseFloat(amount);
                if (isNaN(numAmount) || numAmount <= 0 || cryptoPrices[selectedCrypto].price === null) return 0;
                return numAmount * cryptoPrices[selectedCrypto].price;
            };

            const calculateCryptoAmount = () => {
                const numAmount = parseFloat(amount);
                if (isNaN(numAmount) || numAmount <= 0 || cryptoPrices[selectedCrypto].price === null) return 0;
                return numAmount / cryptoPrices[selectedCrypto].price;
            };

            const formatCurrency = (value) => {
                return new Intl.NumberFormat('pt-BR', {
                    style: 'currency',
                    currency: currency,
                    minimumFractionDigits: 2,
                    maximumFractionDigits: 2
                }).format(value);
            };

            const CustomTooltip = ({ active, payload }) => {
                if (active && payload && payload.length) {
                    return (
                        <div style={{backgroundColor: 'white', padding: '12px', borderRadius: '8px', boxShadow: '0 4px 6px rgba(0,0,0,0.1)', border: '1px solid #e5e7eb'}}>
                            <p style={{fontSize: '14px', fontWeight: '600', color: '#1f2937'}}>{payload[0].payload.fullDate}</p>
                            <p style={{fontSize: '18px', fontWeight: 'bold', color: '#2563eb'}}>
                                {formatCurrency(parseFloat(payload[0].value))}
                            </p>
                        </div>
                    );
                }
                return null;
            };

            return (
                <div style={{minHeight: '100vh', background: 'linear-gradient(to bottom right, #581c87, #1e3a8a, #312e81)', padding: '16px'}}>
                    <div style={{maxWidth: '1024px', margin: '0 auto'}}>
                        <div style={{textAlign: 'center', marginBottom: '32px', paddingTop: '32px'}}>
                            <h1 style={{fontSize: '36px', fontWeight: 'bold', color: 'white', marginBottom: '8px', display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '8px'}}>
                                <DollarSign />
                                Calculadora Cripto
                            </h1>
                            <p style={{color: '#bfdbfe'}}>Calcule o valor de suas criptomoedas em tempo real</p>
                        </div>

                        <div style={{backgroundColor: 'white', borderRadius: '16px', boxShadow: '0 25px 50px -12px rgba(0,0,0,0.25)', padding: '24px', marginBottom: '24px'}}>
                            <div style={{display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '24px'}}>
                                <h2 style={{fontSize: '20px', fontWeight: 'bold', color: '#1f2937'}}>Pre√ßos em Tempo Real</h2>
                                <div style={{display: 'flex', gap: '8px', alignItems: 'center'}}>
                                    <select
                                        value={currency}
                                        onChange={(e) => setCurrency(e.target.value)}
                                        style={{padding: '8px 12px', border: '1px solid #d1d5db', borderRadius: '8px', fontSize: '14px'}}
                                    >
                                        <option value="BRL">BRL (R$)</option>
                                        <option value="USD">USD ($)</option>
                                        <option value="EUR">EUR (‚Ç¨)</option>
                                    </select>
                                    <button
                                        onClick={fetchPrices}
                                        disabled={loading}
                                        style={{padding: '8px', backgroundColor: '#3b82f6', color: 'white', borderRadius: '8px', border: 'none', cursor: 'pointer', opacity: loading ? 0.5 : 1}}
                                    >
                                        <RefreshCw className={loading ? 'animate-spin' : ''} />
                                    </button>
                                </div>
                            </div>

                            <div style={{display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(250px, 1fr))', gap: '16px', marginBottom: '16px'}}>
                                {Object.entries(cryptoPrices).map(([key, data]) => (
                                    <div
                                        key={key}
                                        style={{
                                            padding: '16px',
                                            borderRadius: '12px',
                                            border: selectedCrypto === key ? '2px solid #3b82f6' : '2px solid #e5e7eb',
                                            backgroundColor: selectedCrypto === key ? '#eff6ff' : 'white',
                                            cursor: 'pointer',
                                            transition: 'all 0.2s'
                                        }}
                                        onClick={() => setSelectedCrypto(key)}
                                    >
                                        {data.price === null ? (
                                            <div style={{display: 'flex', alignItems: 'center', justifyContent: 'center', height: '80px'}}>
                                                <RefreshCw className="animate-spin" style={{color: '#9ca3af'}} />
                                            </div>
                                        ) : (
                                            <div style={{display: 'flex', justifyContent: 'space-between', alignItems: 'start'}}>
                                                <div>
                                                    <h3 style={{fontWeight: 'bold', color: '#1f2937'}}>{cryptoNames[key]}</h3>
                                                    <p style={{fontSize: '24px', fontWeight: 'bold', color: '#111827', marginTop: '4px'}}>
                                                        {formatCurrency(data.price)}
                                                    </p>
                                                </div>
                                                <div style={{display: 'flex', alignItems: 'center', gap: '4px', color: data.change >= 0 ? '#16a34a' : '#dc2626'}}>
                                                    {data.change >= 0 ? <TrendingUp /> : <TrendingDown />}
                                                    <span style={{fontWeight: 'bold'}}>{data.change.toFixed(2)}%</span>
                                                </div>
                                            </div>
                                        )}
                                    </div>
                                ))}
                            </div>
                            
                            {lastUpdate && (
                                <p style={{fontSize: '14px', color: '#6b7280', textAlign: 'center'}}>
                                    √öltima atualiza√ß√£o: {lastUpdate}
                                </p>
                            )}
                        </div>

                        <div style={{backgroundColor: 'white', borderRadius: '16px', boxShadow: '0 25px 50px -12px rgba(0,0,0,0.25)', padding: '24px', marginBottom: '24px'}}>
                            <div style={{display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '24px'}}>
                                <h2 style={{fontSize: '20px', fontWeight: 'bold', color: '#1f2937', display: 'flex', alignItems: 'center', gap: '8px'}}>
                                    <BarChart3 />
                                    Hist√≥rico Semanal
                                </h2>
                                <button
                                    onClick={() => setShowChart(!showChart)}
                                    style={{padding: '8px 16px', backgroundColor: '#9333ea', color: 'white', borderRadius: '8px', border: 'none', cursor: 'pointer'}}
                                >
                                    {showChart ? 'Ocultar Gr√°fico' : 'Ver Gr√°fico'}
                                </button>
                            </div>

                            {showChart && (
                                <div>
                                    <div style={{marginBottom: '16px', padding: '12px', backgroundColor: '#eff6ff', borderRadius: '8px'}}>
                                        <p style={{fontWeight: 'bold', color: '#1e3a8a'}}>{cryptoNames[selectedCrypto]}</p>
                                        <p style={{fontSize: '14px', color: '#1e40af'}}>√öltimos 7 dias em {currency}</p>
                                    </div>

                                    {loadingChart ? (
                                        <div style={{display: 'flex', justifyContent: 'center', alignItems: 'center', height: '300px'}}>
                                            <RefreshCw className="animate-spin" style={{width: '32px', height: '32px', color: '#3b82f6'}} />
                                        </div>
                                    ) : (
                                        <ResponsiveContainer width="100%" height={300}>
                                            <LineChart data={chartData}>
                                                <CartesianGrid strokeDasharray="3 3" stroke="#e0e0e0" />
                                                <XAxis 
                                                    dataKey="date" 
                                                    stroke="#666"
                                                    style={{ fontSize: '12px' }}
                                                />
                                                <YAxis 
                                                    stroke="#666"
                                                    style={{ fontSize: '12px' }}
                                                    tickFormatter={(value) => formatCurrency(value)}
                                                />
                                                <Tooltip content={<CustomTooltip />} />
                                                <Line 
                                                    type="monotone" 
                                                    dataKey="price" 
                                                    stroke="#3b82f6" 
                                                    strokeWidth={3}
                                                    dot={{ fill: '#3b82f6', r: 4 }}
                                                    activeDot={{ r: 6 }}
                                                />
                                            </LineChart>
                                        </ResponsiveContainer>
                                    )}

                                    {chartData.length > 0 && !loadingChart && (
                                        <div style={{marginTop: '16px', display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px'}}>
                                            <div style={{padding: '12px', backgroundColor: '#f0fdf4', borderRadius: '8px'}}>
                                                <p style={{fontSize: '12px', color: '#4b5563'}}>Pre√ßo M√°ximo (7d)</p>
                                                <p style={{fontSize: '18px', fontWeight: 'bold', color: '#16a34a'}}>
                                                    {formatCurrency(Math.max(...chartData.map(d => parseFloat(d.price))))}
                                                </p>
                                            </div>
                                            <div style={{padding: '12px', backgroundColor: '#fef2f2', borderRadius: '8px'}}>
                                                <p style={{fontSize: '12px', color: '#4b5563'}}>Pre√ßo M√≠nimo (7d)</p>
                                                <p style={{fontSize: '18px', fontWeight: 'bold', color: '#dc2626'}}>
                                                    {formatCurrency(Math.min(...chartData.map(d => parseFloat(d.price))))}
                                                </p>
                                            </div>
                                        </div>
                                    )}
                                </div>
                            )}
                        </div>

                        <div style={{backgroundColor: 'white', borderRadius: '16px', boxShadow: '0 25px 50px -12px rgba(0,0,0,0.25)', padding: '24px'}}>
                            <h2 style={{fontSize: '20px', fontWeight: 'bold', color: '#1f2937', marginBottom: '24px'}}>Calculadora</h2>
                            
                            <div style={{display: 'flex', flexDirection: 'column', gap: '16px'}}>
                                <div>
                                    <label style={{display: 'block', fontSize: '14px', fontWeight: '500', color: '#374151', marginBottom: '8px'}}>
                                        Criptomoeda Selecionada
                                    </label>
                                    <div style={{padding: '16px', backgroundColor: '#eff6ff', borderRadius: '8px', border: '2px solid #3b82f6'}}>
                                        <p style={{fontWeight: 'bold', color: '#1e3a8a'}}>{cryptoNames[selectedCrypto]}</p>
                                        {cryptoPrices[selectedCrypto].price !== null ? (
                                            <p style={{fontSize: '14px', color: '#1e40af'}}>Pre√ßo atual: {formatCurrency(cryptoPrices[selectedCrypto].price)}</p>
                                        ) : (
                                            <p style={{fontSize: '14px', color: '#1e40af'}}>Carregando pre√ßo...</p>
                                        )}
                                    </div>
                                </div>

                                <div>
                                    <label style={{display: 'block', fontSize: '14px', fontWeight: '500', color: '#374151', marginBottom: '8px'}}>
                                        Quantidade de Cripto
                                    </label>
                                    <input
                                        type="number"
                                        value={amount}
                                        onChange={(e) => setAmount(e.target.value)}
                                        placeholder="Ex: 0.5"
                                        style={{width: '100%', padding: '12px 16px', border: '2px solid #d1d5db', borderRadius: '8px', fontSize: '18px', outline: 'none'}}
                                        onFocus={(e) => e.target.style.borderColor = '#3b82f6'}
                                        onBlur={(e) => e.target.style.borderColor = '#d1d5db'}
                                    />
                                </div>

                                {amount && parseFloat(amount) > 0 && (
                                    <div style={{padding: '24px', background: 'linear-gradient(to right, #f0fdf4, #d1fae5)', borderRadius: '12px', border: '2px solid #86efac'}}>
                                        <p style={{fontSize: '14px', color: '#4b5563', marginBottom: '4px'}}>Valor Total</p>
                                        <p style={{fontSize: '36px', fontWeight: 'bold', color: '#16a34a', marginBottom: '16px'}}>
                                            {formatCurrency(calculateValue())}
                                        </p>
                                        <div style={{paddingTop: '16px', borderTop: '1px solid #86efac'}}>
                                            <p style={{fontSize: '14px', color: '#4b5563', marginBottom: '4px'}}>Ou compre com {formatCurrency(parseFloat(amount))}</p>
                                            <p style={{fontSize: '24px', fontWeight: 'bold', color: '#374151'}}>
                                                {calculateCryptoAmount().toFixed(8)} {selectedCrypto.toUpperCase()}
                                            </p>
                                        </div>
                                    </div>
                                )}
                            </div>
                        </div>

                        <div style={{marginTop: '24px', textAlign: 'center', color: '#bfdbfe', fontSize: '14px'}}>
                            <p>üí° Dica: Os pre√ßos s√£o atualizados automaticamente a cada minuto</p>
                        </div>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<CryptoCalculator />);
    </script>
    
    <style>
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .animate-spin {
            animation: spin 1s linear infinite;
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        }
    </style>
</body>
</html>
